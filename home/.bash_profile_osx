# ~/.bash_profile_osx
#
# Author Augusto Pascutti <augusto.hp@gmail.com>
# Part of http://github.com/augustohp/warwick

echo "macOS specifics ...";

# Installs [homebrew][]
if [ -z "$(which brew)" ]
then
	echo "Installing homebrew ..."
	/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
	echo "Installing bash completion ..."
	brew install bash-completion
	brew tap homebrew/completions
fi

# [homebrew][] bash-completion support
source $(brew --prefix)/etc/bash_completion

# Prefer [homebrew][] binaries
export PATH="/usr/local/sbin:/usr/local/bin:$PATH"
# Makes [phpbrew][] reconize [homebrew][]
export PHPBREW_LOOKUP_PREFIX=$(brew --prefix)

# Fixes `pbcopy` on `tmux` for macosSierra
# https://github.com/tmux/tmux/issues/543#issuecomment-248980734
TMUX=$(which tmux)
HOMEBREW=$(which brew)
if [ ! -z "$TMUX" -a ! -z "$HOMEBREW" ]
then
	required_formula=reattach-to-user-namespace
	NEEDS_FIXING=$($HOMEBREW ls | grep $required_formula)
	if [ -z "$NEEDS_FIXING" ]
	then
		echo "Installing fix to pbcopy on tmux..."
		$HOMEBREW install $required_formula
	fi
fi

alias awk=gawk
alias sed=gsed
alias ls="ls -G"

# [phpbrew]: https://github.com/phpbrew/phpbrew "Like pipenv, rubenv, nvm, but for PHP: Manage multiple PHP versions"
# [homebrew]: https://brew.sh/ "The closest thing to an apt-get on a macOS"
